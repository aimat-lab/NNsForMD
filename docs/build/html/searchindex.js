Search.setIndex({docnames:["index","modules","pyNNsMD","pyNNsMD.nn_pes_src"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,sphinx:56},filenames:["index.rst","modules.rst","pyNNsMD.rst","pyNNsMD.nn_pes_src.rst"],objects:{"":{pyNNsMD:[2,0,0,"-"]},"pyNNsMD.nn_pes":{NeuralNetPes:[2,1,1,""]},"pyNNsMD.nn_pes.NeuralNetPes":{"export":[2,2,1,""],call:[2,2,1,""],create:[2,2,1,""],fit:[2,2,1,""],load:[2,2,1,""],merge:[2,2,1,""],predict:[2,2,1,""],resample:[2,2,1,""],save:[2,2,1,""],shuffle:[2,2,1,""],update:[2,2,1,""]},"pyNNsMD.nn_pes_src":{activ:[3,0,0,"-"],callbacks:[3,0,0,"-"],data:[3,0,0,"-"],device:[3,0,0,"-"],fit:[3,0,0,"-"],hyper:[3,0,0,"-"],layers:[3,0,0,"-"],legacy:[3,0,0,"-"],loss:[3,0,0,"-"],models_eg:[3,0,0,"-"],models_feat:[3,0,0,"-"],models_nac:[3,0,0,"-"],oracle:[3,0,0,"-"],plot:[3,0,0,"-"]},"pyNNsMD.nn_pes_src.activ":{identify_keras_activation:[3,3,1,""],leaky_softplus:[3,3,1,""],shifted_softplus:[3,3,1,""]},"pyNNsMD.nn_pes_src.callbacks":{EarlyStopping:[3,1,1,""],lr_exp_reduction:[3,3,1,""],lr_lin_reduction:[3,3,1,""],lr_step_reduction:[3,3,1,""]},"pyNNsMD.nn_pes_src.callbacks.EarlyStopping":{on_epoch_end:[3,2,1,""],on_train_begin:[3,2,1,""],on_train_end:[3,2,1,""]},"pyNNsMD.nn_pes_src.data":{datalist_make_random_shuffle:[3,3,1,""],index_data_in_y_dict:[3,3,1,""],index_make_random_shuffle:[3,3,1,""],merge_data_in_chunks:[3,3,1,""],model_save_data_to_folder:[3,3,1,""],split_validation_training_index:[3,3,1,""]},"pyNNsMD.nn_pes_src.device":{set_gpu:[3,3,1,""]},"pyNNsMD.nn_pes_src.fit":{fit_model_energy_gradient:[3,3,1,""],fit_model_energy_gradient_async:[3,3,1,""],fit_model_get_python_cmd_os:[3,3,1,""],fit_model_nac:[3,3,1,""],fit_model_nac_async:[3,3,1,""],get_path_for_fit_script:[3,3,1,""]},"pyNNsMD.nn_pes_src.layers":{Angles:[3,1,1,""],Dihydral:[3,1,1,""],EmptyGradient:[3,1,1,""],EnergyGradient:[3,1,1,""],InverseDistance:[3,1,1,""],MLP:[3,1,1,""],NACGradient:[3,1,1,""],PropagateEnergyGradient:[3,1,1,""],PropagateNACGradient:[3,1,1,""],RevertStandardizeLabels:[3,1,1,""],ScalarStandardize:[3,1,1,""],StandardizeFeatures:[3,1,1,""]},"pyNNsMD.nn_pes_src.layers.Angles":{build:[3,2,1,""],call:[3,2,1,""],get_config:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.Dihydral":{build:[3,2,1,""],call:[3,2,1,""],get_config:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.EmptyGradient":{build:[3,2,1,""],call:[3,2,1,""],get_config:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.EnergyGradient":{build:[3,2,1,""],call:[3,2,1,""],get_config:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.InverseDistance":{build:[3,2,1,""],call:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.MLP":{build:[3,2,1,""],call:[3,2,1,""],get_config:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.NACGradient":{build:[3,2,1,""],call:[3,2,1,""],get_config:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.PropagateEnergyGradient":{build:[3,2,1,""],call:[3,2,1,""],get_config:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.PropagateNACGradient":{build:[3,2,1,""],call:[3,2,1,""],get_config:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.RevertStandardizeLabels":{build:[3,2,1,""],call:[3,2,1,""],get_config:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.ScalarStandardize":{build:[3,2,1,""],call:[3,2,1,""]},"pyNNsMD.nn_pes_src.layers.StandardizeFeatures":{build:[3,2,1,""],call:[3,2,1,""],get_config:[3,2,1,""]},"pyNNsMD.nn_pes_src.legacy":{call_model_energy_gradient_precomputed:[3,3,1,""],call_model_nac_precomputed:[3,3,1,""],compute_feature_derivative:[3,3,1,""],predict_model_energy_gradient:[3,3,1,""],predict_model_energy_gradient_precomputed:[3,3,1,""],predict_model_nac:[3,3,1,""],predict_model_nac_precomputed:[3,3,1,""]},"pyNNsMD.nn_pes_src.loss":{get_lr_metric:[3,3,1,""],merge_hist:[3,3,1,""],nac_loss:[3,3,1,""],r2_metric:[3,3,1,""]},"pyNNsMD.nn_pes_src.models_eg":{EnergyModel:[3,1,1,""],EnergyModelPrecomputed:[3,1,1,""],create_model_energy_gradient_precomputed:[3,3,1,""]},"pyNNsMD.nn_pes_src.models_eg.EnergyModel":{call:[3,2,1,""]},"pyNNsMD.nn_pes_src.models_eg.EnergyModelPrecomputed":{predict_step:[3,2,1,""],test_step:[3,2,1,""],train_step:[3,2,1,""]},"pyNNsMD.nn_pes_src.models_feat":{FeatureModel:[3,1,1,""],create_feature_models:[3,3,1,""]},"pyNNsMD.nn_pes_src.models_feat.FeatureModel":{predict_in_chunks:[3,2,1,""],predict_step:[3,2,1,""]},"pyNNsMD.nn_pes_src.models_nac":{NACModel:[3,1,1,""],NACModelPrecomputed:[3,1,1,""],create_model_nac_precomputed:[3,3,1,""]},"pyNNsMD.nn_pes_src.models_nac.NACModel":{call:[3,2,1,""]},"pyNNsMD.nn_pes_src.models_nac.NACModelPrecomputed":{predict_step:[3,2,1,""],test_step:[3,2,1,""],train_step:[3,2,1,""]},"pyNNsMD.nn_pes_src.oracle":{find_samples_with_max_error:[3,3,1,""]},"pyNNsMD.nn_pes_src.plot":{find_max_relative_error:[3,3,1,""],plot_energy_gradient_fit_result:[3,3,1,""],plot_nac_fit_result:[3,3,1,""],plot_resampling_gradient:[3,3,1,""],plot_resampling_nac:[3,3,1,""]},pyNNsMD:{nn_pes:[2,0,0,"-"],nn_pes_src:[3,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:function"},terms:{"0001":3,"001":3,"005":3,"100":3,"1000":3,"10000":3,"2000":[],"2020":3,"21138624598853":[],"250":[],"265":[],"3000":[],"4000":[],"42206747624915":[],"500":3,"5000":3,"600":[],"8897261246229133":[],"abstract":3,"andr\u00e9":3,"boolean":3,"case":3,"class":[2,3],"default":[2,3],"export":[2,3],"final":3,"float":[2,3],"function":3,"import":3,"int":3,"new":[2,3],"return":[2,3],"true":[2,3],"try":2,For:3,NNs:2,NOT:3,PES:[],The:[2,3],Thes:2,These:3,Use:[2,3],Used:3,__init__:2,abov:3,absolut:3,accept:3,access:2,accuraci:3,action:3,activ:[1,2],activ_alpha:[],adapt:3,add:2,addit:3,adiabat:2,all:[2,3],allind:3,alloc:3,allow:2,almost:3,along:3,alpha:3,also:[2,3],alwai:[2,3],angl:3,angle_index:3,angle_mean:[],angle_std:[],angstroem:2,ani:3,anymor:3,api:3,arai:2,arg:3,argument:3,arrai:[2,3],arri:3,assign:[2,3],ativ:3,atom:[2,3],aug:[],author:3,avail:2,axi:[2,3],backpropag:3,base:[2,3],base_lay:3,basic:3,batch:[2,3],batch_siz:3,batch_size_predict:3,befor:[2,3],begin:3,beginnig:3,beta:3,between:3,bit:3,bohr:2,bool:[2,3],both:[2,3],build:[2,3],calcul:3,call:[2,3],call_model_energy_gradi:[],call_model_energy_gradient_precomput:3,call_model_nac:[],call_model_nac_precomput:3,callback:[1,2],callbacklist:3,can:[2,3],cast:2,categori:2,certain:[2,3],chang:3,chunk:3,circumst:3,class_nam:3,code:3,com:3,combin:3,command:3,commandlin:3,compil:3,complet:2,comput:3,compute_feature_deriv:3,compute_mask:3,config:3,configur:3,connect:3,consist:2,constant:3,contain:[2,3],content:1,coordin:[2,3],correct:2,could:3,coupl:2,creat:[2,3],create_feature_model:3,create_model_energy_gradi:[],create_model_energy_gradient_precomput:3,create_model_nac:[],create_model_nac_precomput:3,creation:3,current:3,custom:3,data1:3,data2:3,data:[1,2],data_i:3,data_x:3,datafold:2,datalength:2,datalist2:2,datalist:[2,3],datalist_make_random_shuffl:3,dataset:[2,3],dcitionari:3,decai:3,defin:[],definit:3,defualt:3,delta_loss:[],depend:3,depth:3,deriv:3,descriptor:3,detail:3,deviat:3,devic:[1,2],dict:[2,3],dictionari:[2,3],differ:3,dihyd_index:3,dihyd_mean:[],dihyd_std:[],dihydr:3,dir_sav:3,directori:[2,3],distribut:3,divid:3,do_offset:3,doe:3,downward:3,dropout:3,dump:3,dure:[2,3],each:[2,3],eagerli:3,earli:3,earlystop:3,eberhard:3,effect:2,either:3,emptygradi:3,enabl:2,end:3,energi:[2,3],energy_gradi:[2,3],energygradi:3,energymodel:3,energymodelprecomput:3,engin:3,epo:3,epoch:3,epoch_step_reduct:[],epomin:3,epostep:3,err_total_dict:3,error:[2,3],estim:2,etc:[2,3],eval:3,evalu:3,everi:2,exampl:[2,3],execut:2,exist:2,expect:3,explan:2,exponenti:3,facr:3,factor:3,factor_lr:[],fail:3,fals:[2,3],faster:2,feat:3,featur:3,featuremodel:3,ferr:2,fetchabl:3,file:2,filenotfounderror:2,filepath:3,fill:2,find:3,find_max_relative_error:3,find_samples_with_max_error:3,fit:[1,2],fit_error:3,fit_model_energy_gradi:3,fit_model_energy_gradient_async:3,fit_model_get_python_cmd_o:3,fit_model_nac:3,fit_model_nac_async:3,fitmod:[2,3],fitresult:3,flatten:3,folder:[2,3],forc:3,force_phase_loss:[],form:2,forward:3,found:2,fraction:2,fri:[],from:[2,3],full:3,fun:3,func:3,further:2,futur:3,gener:[2,3],get:3,get_config:3,get_lr_metr:3,get_path_for_fit_script:3,github:3,goal:3,gpu:[2,3],gpu_dist:2,gpu_ids_list:3,gradient:[2,3],gradienttap:[],graph:3,growth:3,handl:3,has:3,hatr:2,hatre:2,have:[2,3],here:[2,3],hist1:3,hist2:3,hist:3,histogram:3,hold:2,how:3,http:3,hyp_dict:2,hyper:[1,2],hyper_create_model_nac:3,hyper_dict2:2,hyper_dict:2,hyper_eg:2,hyper_model_energy_gradi:3,hyper_nac:2,hyper_predict_model_energy_gradi:3,hyper_predict_model_nac:3,hyperparamet:[2,3],hyperparamt:2,i_train:3,i_val:3,idea:3,identifi:3,identify_keras_activ:3,identify_regular:[],implement:3,includ:3,ind:3,index:[0,2,3],index_data_in_y_dict:3,index_make_random_shuffl:3,indexarrai:3,indexlist:3,indic:[2,3],individu:2,inf:3,infer:3,info:3,inform:[2,3],initi:[2,3],input:3,input_shap:3,instanc:[2,3],instanti:3,instead:3,instr:3,integ:3,interfac:3,invd_index:3,invd_mean:[],invd_std:[],inversedist:3,iter:2,its:3,itself:2,jul:3,junk:3,just:3,kear:3,keep:[2,3],kei:3,kept:2,kera:[2,3],keyword:3,kwarg:3,l1_str:[],l2_str:[],lambda:3,larg:2,last:3,later:3,layer:[1,2],leak:3,leaki:3,leaky_softplu:3,leakyrelu:3,learn:[2,3],learning_r:3,learning_rate_compil:[],learning_rate_start:3,learning_rate_step:[],learning_rate_stop:3,learningrateschedul:3,learnrate_epoch:3,learnrate_step:3,leav:3,left:3,legaci:[1,2],length:3,like:2,linear:3,list:[2,3],littl:3,live:3,load:2,local:3,log:3,logic:3,loop:2,loss:[1,2],loss_monitor:[],loss_weight:3,lr_exp_reduct:3,lr_lin_reduct:3,lr_schedule_step:3,lr_start:3,lr_step_reduct:3,machin:3,made:3,mai:3,main:[2,3],main_dir:[],make:3,make_phase_loss:3,make_predict_funct:3,make_test_funct:3,make_train_funct:3,manag:2,mani:3,mask:3,match:3,mathemet:3,max_tim:[],maximum:3,mean:[2,3],memeori:3,memori:[2,3],merg:[2,3],merge_data_in_chunk:3,merge_hist:3,method:3,metric:3,min_delta:3,min_lr:3,minepoch:3,minimum:3,minut:3,miss:2,mlp:3,mod_dir:3,mode:3,model2:2,model:[2,3],model_dir:[],model_nam:[2,3],model_save_data_to_fold:3,model_typ:2,modelnam:2,models_eg:[1,2],models_feat:[1,2],models_nac:[1,2],modul:[0,1],mol2:2,mol2_energi:2,mol2_nac:2,monitor:3,more:3,mpi:3,mse:3,mult_nn:2,multipl:[2,3],must:3,nac:[2,3],nac_loss:3,nacgradi:3,nacmodel:3,nacmodelprecomput:3,name:[2,3],necessari:3,need:3,nerual:3,nest:3,network:[2,3],neural:2,neuralnetp:2,nn_pe:1,nn_pes_activ:[],nn_pes_callback:[],nn_pes_data:[],nn_pes_devic:[],nn_pes_fit:[],nn_pes_hyp:[],nn_pes_lay:[],nn_pes_legaci:[],nn_pes_loss:[],nn_pes_model:[],nn_pes_models_class:[],nn_pes_oracl:[],nn_pes_plot:[],nn_pes_predict:[],nn_pes_reg:[],nn_pes_src:[1,2],nn_pes_training_eg:[],nn_pes_training_nac:[],nn_size:3,nn_util:2,non:2,none:[2,3],nor:3,normal:3,note:[2,3],now:3,number:3,numpi:[2,3],object:2,obtian:3,offset:3,offset_step:3,old:3,on_epoch_end:3,on_train_batch_end:3,on_train_begin:3,on_train_end:3,one:3,onli:3,oper:2,oppos:3,ops:3,optim:[2,3],option:[2,3],oracl:[1,2],origin:[2,3],out:[2,3],out_dir:2,out_error:2,out_fiterr:2,out_index:[2,3],out_testerr:2,outhist:3,outlist:[2,3],output:3,overrid:3,overridden:3,packag:1,page:0,parallel:[2,3],paramet:[2,3],paramt:3,pass:[2,3],patchmeifyoucan:3,path:3,patienc:3,patrick:3,per:3,perform:3,pes:3,phase_less_loss:[],phaseindepend:3,phaseless:3,pickl:3,plot:[1,2],plot_energy_gradient_fit_result:3,plot_nac_fit_result:3,plot_resampling_gradi:3,plot_resampling_nac:3,plu:[2,3],point:3,pool_error:3,popen:3,possibl:[2,3],potenti:3,pre_epo:[],precomput:3,pred:3,pred_err:3,predict:[2,3],predict_in_chunk:3,predict_model_energy_gradi:3,predict_model_energy_gradient_precomput:3,predict_model_nac:3,predict_model_nac_precomput:3,predict_step:3,predtrain:3,predval:3,prefix:3,prelm:3,prenam:3,principl:2,proc_async:2,process:3,propagateenergygradi:3,propagatenacgradi:3,proper:3,provid:[2,3],pyhton3:3,pyhton:3,pynnsmd:0,pyr_vers:[],python:[2,3],r2_metric:3,rais:2,random_shuffl:[2,3],rate:3,read:3,reappli:3,reason:2,recreat:2,reduc:[2,3],reduct:3,redund:[],referenc:2,reg:[],reg_l1:[],reg_l2:[],reg_str:[],regardless:3,regular:[],regularizatio:[],reinit_weight:[],reinstanti:3,rel:3,remain:3,replac:[],requir:2,resampl:[2,3],rescal:3,respect:2,restore_weights_on_lr_decai:3,restrict:3,result:[2,3],retrain:2,revertstandard:[],revertstandardizelabel:3,routin:2,run:[2,3],run_eagerli:3,runtim:2,same:[2,3],sampl:[2,3],save:[2,3],savedmodel:2,scalar:3,scalarstandard:3,scale:3,schedul:3,scope:2,script:[2,3],search:0,see:2,segment:2,separ:3,seper:[],serializ:3,server:3,set:[2,3],set_gpu:3,shape:[2,3],shift:3,shifted_sofplu:[],shifted_softplu:3,should:3,shuffl:[2,3],shuffle_ind:2,similar:3,sinc:3,singl:[2,3],size:[2,3],slope:3,slower:2,slurm:3,small:2,smooth:3,softplu:3,solut:3,solv:3,sort:3,specifi:2,split:[2,3],split_siz:3,split_validation_training_index:3,splitsiz:3,standardizefeatur:3,start:3,state:3,statist:3,step:3,stepsiz:2,stop:3,store:[2,3],store_weight:3,str:[2,3],strategi:3,string:3,structur:3,subclass:3,submodul:1,subpackag:1,subprocess:3,support:3,suppos:[2,3],take:3,taken:3,target_model:3,temp:3,temp_:3,temp_g:3,tensor:3,tensorflow:[2,3],tensorfow:3,tensorshap:3,test:[2,3],test_error:3,test_siz:2,test_step:3,than:3,thei:[2,3],thi:3,thu:[],tool:3,total:3,toward:3,train:[2,3],train_step:3,training_:[2,3],training_eg:[1,2],training_nac:[1,2],try_predict_hessian:[],tue:3,tupl:3,two:[2,3],type:[2,3],typic:3,uncertainti:2,unit:[2,3],unit_energi:3,unit_energy_conv:3,unit_forc:3,unit_force_conv:3,unit_gradi:[],unit_nac:3,unit_nac_conv:3,unitconverion:3,unitconvers:3,unseen:2,unus:3,updat:[2,3],use:[2,3],use_bond_angl:[],use_dihyd_angl:[],use_dropout:3,use_early_callback:[],use_exp_callback:[],use_invdist:[],use_linear_callback:[],use_reg_activ:3,use_reg_bia:3,use_reg_weight:3,use_step_callback:[],used:[2,3],using:[],val_:3,val_disjoint:[],val_loss:3,val_split:2,valid:[2,3],valu:[2,3],variabl:3,veri:3,virut:3,visibl:3,wai:[2,3],wed:[],weight:[2,3],well:[2,3],where:3,wherea:3,whether:[2,3],which:[2,3],within:2,withmodel:3,without:[2,3],work:[2,3],xtrain:3,xval:3,y_dict:3,y_energy_mean:[],y_energy_std:[],y_energy_unit_conv:[],y_gradient_unit_conv:[],y_nac_mean:[],y_nac_std:[],y_nac_unit_conv:[],y_out:3,y_pred:3,y_true:3,you:[2,3],ytrain:3,yval:3},titles:["General Information","pyNNsMD","pyNNsMD package","pyNNsMD.nn_pes_src package"],titleterms:{activ:3,callback:3,content:[0,2,3],data:3,devic:3,document:[],fit:3,gener:0,hyper:3,indic:0,inform:0,layer:3,legaci:3,loss:3,models_eg:3,models_feat:3,models_nac:3,modul:[2,3],nn_pe:2,nn_pes_activ:[],nn_pes_callback:[],nn_pes_data:[],nn_pes_devic:[],nn_pes_fit:[],nn_pes_hyp:[],nn_pes_lay:[],nn_pes_legaci:[],nn_pes_loss:[],nn_pes_model:[],nn_pes_models_class:[],nn_pes_oracl:[],nn_pes_plot:[],nn_pes_predict:[],nn_pes_reg:[],nn_pes_src:3,nn_pes_training_eg:[],nn_pes_training_nac:[],oracl:3,packag:[0,2,3],plot:3,predict:[],pynnsmd:[1,2,3],reg:[],submodul:[2,3],subpackag:2,tabl:0,training_eg:3,training_nac:3,welcom:[]}})